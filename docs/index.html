<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Resolution-robust Large Mask Inpainting with Fourier Convolutions">

  <script>
    MathJax = {
      tex: {
        inlineMath: [
          ['$', '$'],
          ['\\(', '\\)']
        ]
      }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">

  </script>

  <title>Resolution-robust Large Mask Inpainting with Fourier Convolutions</title>

  <!-- Bootstrap core CSS -->
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom fonts for this template -->
  <link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <link href="vendor/simple-line-icons/css/simple-line-icons.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" rel="stylesheet"
    type="text/css">

  <!-- Custom styles for this template -->
  <link href="css/landing-page.min.css" rel="stylesheet">

</head>

<body>

  <!-- Masthead -->
  <!-- <header class="masthead text-white text-center">
    <div class="container">
      <div class="overlay"></div>
      <div class="row">
        <div class="offset-md-1 col-md-10">
          <video class="video video-header" loop="loop" autoplay muted>
            <source src="vids/video_200.webm" type="video/webm" />
            Your browser doesn't support .webm video
          </video>
        </div>
        <div class="col-xl-9 mx-auto">
          <br /><br />
          <h1 class="mb-5"><span class="title">Resolution-robust Large Mask Inpainting with Fourier Convolutions</span></h1>
          <h5 class="mb-5"><span class="title">WACV 2022 paper</span></h5>
        </div>
      </div>
    </div>
  </header> -->


  <!-- Testimonials -->
  <section class="testimonials text-center">
    <div class="col-xl-9 mx-auto">
      <br /><br />
      <h1 class="mb-5"><span>Resolution-robust Large Mask Inpainting with Fourier Convolutions
    </span></h1>
      <h5 class="mb-5"><span>WACV 2022</span></h5>
    </div>

    <div class="container">
      <div class="row">
        <div class="col-md-3 ">
          <div class="testimonial-item mx-auto mb-5 mb-lg-0">
            <h5>
                Roman Suvorov
            </h5>
            <p class="font-weight-light mb-0"></p>
          </div>
        </div>
        <div class="col-md-3">
          <div class="testimonial-item mx-auto mb-5 mb-lg-0">
            <h5>
                Elizaveta Logacheva
            </h5>
            <p class="font-weight-light mb-0"></p>
          </div>
        </div>
        <div class="col-md-3">
          <div class="testimonial-item mx-auto mb-5 mb-lg-0">
            <h5>
                Anton Mashikhin
            </h5>
            <p class="font-weight-light mb-0"></p>
          </div>
        </div>
        <div class="col-md-3">
          <div class="testimonial-item mx-auto mb-5 mb-lg-0">
            <h5>
                Anastasia Remizova
            </h5>
            <p class="font-weight-light mb-0"></p>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-3">
          <div class="testimonial-item mx-auto mb-5 mb-lg-0">
            <h5>
                Arsenii Ashukha
            </h5>
            <p class="font-weight-light mb-0"></p>
          </div>
        </div>
        <div class="col-md-3">
          <div class="testimonial-item mx-auto mb-5 mb-lg-0">
            <h5>
                Aleksei Silvestrov
            </h5>
            <p class="font-weight-light mb-0"></p>
          </div>
        </div>
        <div class="col-md-3 ">
          <div class="testimonial-item mx-auto mb-5 mb-lg-0">
            <h5>
                Naejin Kong
            </h5>
            <p class="font-weight-light mb-0"></p>
          </div>
        </div>
        <div class="col-md-3">
          <div class="testimonial-item mx-auto mb-5 mb-lg-0">
            <h5>
                Harshith Goka
            </h5>
            <p class="font-weight-light mb-0"></p>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="offset-md-3 col-md-3">
          <div class="testimonial-item mx-auto mb-5 mb-lg-0">
            <h5>
                Kiwoong Park
            </h5>
            <p class="font-weight-light mb-0"></p>
          </div>
        </div>

        <div class="col-md-3 ">
          <div class="testimonial-item mx-auto mb-5 mb-lg-0">
            <h5>
                Victor Lempitsky
            </h5>
            <p class="font-weight-light mb-0"></p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Icons Grid -->
  <section class="features-icons text-center">
    <div class="container">
      <div class="row">
        <div class="col-md-2">
          <a href="https://arxiv.org/abs/2109.07161" style="text-decoration : none; color : #000000;">
            <div class="features-icons-item mx-auto mb-5 mb-lg-0 mb-lg-3">
              <div class="features-icons-icon d-flex">
                <i class="fa fa-file-text m-auto text-primary"></i>
              </div>
              <h3>Paper</h3>
              <p class="mylead mb-0">Download pdf</p>
            </div>
          </a>
        </div>

        <!-- Appendix -->
        <div class="col-md-2">
          <a href="lama_supmat_2021.pdf" style="text-decoration : none; color : #000000;">
            <div class="features-icons-item mx-auto mb-5 mb-lg-0 mb-lg-3">
              <div class="features-icons-icon d-flex">
                <i class="fa fa-file-text m-auto text-primary"></i>
              </div>
              <h3>SuppMat</h3>
              <p class="mylead mb-0">More examples</p>
            </div>
          </a>
        </div>

        <div class="col-md-2">
          <a href="https://github.com/advimman/lama" style="text-decoration : none; color : #000000;">
            <div class="features-icons-item mx-auto mb-0 mb-lg-3">
              <img loading="lazy"  height="110px" src="img/git.png" />
              <br>
              <h3>Code</h3>
              <p class="mylead mb-0">Checkout the code<br></p>
            </div>
          </a>
        </div>


        <!-- Appendix -->
        <div class="col-md-2">
          <a href="https://colab.research.google.com/github/advimman/lama/blob/master/colab/LaMa_inpainting.ipynb"
            style="text-decoration : none; color : #000000;">
            <div class="features-icons-item mx-auto mb-5 mb-lg-0 mb-lg-3">
              <img loading="lazy"  height="110px" src="img/colab.png" />
              <br>
              <h3>Collab</h3>
              <p class="mylead mb-0">Inpaint online<br></p>
            </div>
          </a>
        </div>

        <div class="col-md-2">
          <a href="./cite.txt" style="text-decoration : none; color : #000000;">
            <div class="features-icons-item mx-auto mb-0 mb-lg-3">
              <div class="features-icons-icon d-flex">
                <i class="fa fa-graduation-cap m-auto text-primary"></i>
              </div>
              <h3>BibTex</h3>
              <p class="mylead mb-0">Cite the paper</p>
            </div>
          </a>
        </div>

        <div class="col-md-2">
          <a href="https://www.casualganpapers.com/large-masks-fourier-convolutions-inpainting/LaMa-explained.html" style="text-decoration : none; color : #000000;">
            <div class="features-icons-item mx-auto mb-0 mb-lg-3">
              <img loading="lazy"  height="110px" src="https://raw.githubusercontent.com/advimman/lama-project/main/docs/img/cgp_logo.png" />
              <br>
              <h3>Summary</h3>
              <p class="mylead mb-0">Casual GAN Papers<br></p>
            </div>
          </a>
        </div>
      </div>
    </div>
  </section>




  <!-- Image Showcases -->
  <section class="showcase px-2">

    <div class="container">

      <div class="row myrow">
        <div class="row">
          <div class="offset-md-0 col-md-12 text-white">
            <img   class="img-fluid mb-3" src="img/intro.gif" alt="" width="100%">
          </div>
                      <div class="lead mb-0">
              <center> 
              <br>
              <br>
              <br>
              <br>
              <b style="font-size:30px;">üî•üî•üî•
                <br>
                <b>LaMa generalizes surprisingly well to much higher resolutions (~2k‚ùóÔ∏è) than it saw during training (256x256), and achieves the excellent performance even in challenging scenarios, e.g. completion of periodic structures.</b>
              <br>
              <br>
              <br>
              <br>
            </center>
                
          <div class="offset-md-0 col-md-12 text-white">
            <img   class="img-fluid mb-3" src="https://raw.githubusercontent.com/senya-ashukha/senya-ashukha.github.io/master/projects/lama_21/gif_for_lightning_v1_white.gif" alt="" width="100%">
          </div>
            
          <div class="offset-md-0 col-md-12">
            <h2 style="text-align: center; margin-top:40px;">Abstract</h2>
            <div class="lead mb-0" align="justify">
              Modern image inpainting systems, despite the significant progress, often struggle with large missing
              areas,
              complex geometric structures,
              and high-resolution images. We find that one of the main reasons for that is the lack of an ef-fective
              receptive field in both the inpainting network andthe loss function.
              To alleviate this issue, we propose anew method called large mask inpainting (LaMa).
              LaM ais based on:
            </div>
            <ul style="margin-top: 20px; padding-bottom: 20px;" class=" lead mb-0">
              <li>a new inpainting network architecture that uses fast Fourier convolutions,
                which have the image-widereceptive field</li>
              <li> a high receptive field perceptual loss;</li>
              <li> large training
                masks,
                which unlocks the potential ofthe first two components.</li>
            </ul>
            <div class="lead mb-0">
              Our inpainting network improves the state-of-the-art across a range of datasets and achieves excellent
              performance
              even in challenging scenarios, e.g.completion of periodic structures. Our model generalizes
              surprisingly well to resolutions that are higher than thoseseen at train time, and achieves this at lower
              parameter & compute
              costs than the competitive baselines.
            </div>


            <p></p>
          </div>
          <div class="offset-md-0 col-md-12 text-white">
            <img loading="lazy"  class="img-fluid mb-3" src="img/scheme.png" alt="" width="100%">
          </div>
          <!-- 
      <div class="row myrow">
        <div class="offset-md-1 col-md-10">
          <h2>DeepLandscape in 1 min.</h2>
        </div>
      </div>

      <div class="offset-md-1 col-md-8 row iframe-container col-md-10">
        <iframe src="https://www.youtube.com/embed/2CoQRf5qXWY" frameborder="0"
          allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
      </div>
      <br /><br />
      <div class="row myrow">
        <div class="offset-md-1 col-md-10">
          <h2>DeepLandscape explained</h2>
        </div>
      </div>

      <div class="row iframe-container col-md-10 offset-md-1">
        <iframe src="https://www.youtube.com/embed/mnYIx9DwVlE" frameborder="0"
          allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
      </div>

 -->
          <!-- <div class="row myrow">
        <div class="offset-md-1 col-md-10">
          <h2>Method</h2>
        </div>
      </div>
      <div class="row myrow">
        <div class="offset-md-1 col-md-10">

          <p class="lead mb-2" align="justify">
          Our goal is to inpaint a color image $x$ masked by a binary mask of unknown pixels $m$, the masked image is denoted as $x \odot m$. 
            The mask $m$ is stacked with the masked image $x\odot m$, resulting in a four-channel input tensor $x'=\texttt{stack}(x\odot m,m)$.
             We use a feed-forward inpainting network $f_\theta(\cdot)$, that we also refer to as generator. Taking $x'$, 
             the inpainting network processes the input in a fully-convolutional manner,
              and produces an inpainted three-channel color image $\hat{x}=f_\theta(x')$ .  
          The training is performed on a dataset of~(image, mask)~pairs obtained from real images and synthetically generated masks.
          </p>
      <br />
          <h4 class="mb-2">Global context within early layers</h4>
          <p class="lead mb-2" align="justify">
            In challenging cases, e.g. filling of large masks, the generation of proper inpainting requires to consider global context. 
            Thus, we argue that a good architecture should have units with as wide-as-possible receptive field as early as possible in the pipeline.
             The conventional fully convolutional models, e.g. ResNet, suffer from slow growth of effective receptive field.
Receptive field might be insufficient, especially in the early layers of the network, due to the typically small (e.g. $3\times3$) convolutional kernels. 
Thus, many layers in the network will be lacking global context and will waste computations and parameters to create one.
For wide masks, the whole receptive field of a generator at the specific position may be inside the mask, thus observing only missing pixels.
The issue becomes especially pronounced for high-resolution images. 
            </p>
<p class="lead mb-2" align="justify">
Fast Fourier convolutions is the recently proposed approach that allows to use global context in early layers. 
Fourier convolution layer is based on a channel-wise fast Fourier transform (FFT) and has image-wide receptive field that covers the entire image. 
Fourier convolution layer splits channels into two parallel branches: local branch uses conventional convolutions, 
and global branch uses real FFT to account for global context. Real FFT can be applied only to real valued signals, as well as inverse real FFT
ensures that the output is real valued. Real FFT uses only half of the spectrum compared to the FFT. 
</p>

          <p class="lead mb-2" align="justify">The power of Fourier convolutions
Fourier convolutions are fully differentiable and are easy-to-use drop-in replacement for conventional convolutions.
Due to the image-wide receptive field that covers the entire image, 
Fourier convolutions allow the generator network to account for the global context starting from the early layers, which is crucial 
for high-resolution image inpainting. This also leads to better efficiency: trainable parameters can be used for reasoning and generation instead of 
"waiting" for a slow propagation of information.

Another benefit of Fourier convolutions is the ability to capture periodic structures which are very common in human-made environments, 
e.g bricks, ladders, windows, etc. 
Interestingly, sharing the identical convolutions across all frequencies shifts the model towards scale covariance.
        </div>
      </div> -->

          <!--<div>
        <div class="row">
          <div class="offset-md-1 col-md-10 text-white">
            <img loading="lazy"  class="img-fluid mb-3" src="img/02_architecture.jpg">
          </div>
        </div>
      </div>
      <div class="row myrow">
        <div class="offset-md-1 col-md-10">
          <h4>Animating Real Scenery Images</h4>
          <p class="lead mb-0" align="justify">
            To animate a given (real) scenery image $I$, we find (infer) a set of latent variables that produce such
            image within the generator.
            We perform inference using the following three-step procedure:
            <br \>
            Step 1: Predict a set of style vectors $W^{\prime}$ (the notation is described in the paper) using a
            feedforward encoder
            network.<br />
            Step 2: Starting from $\mathcal{W}^\prime$ and zero $\mathcal{S}$, we optimize all latents to improve
            reconstruction error.<br />
            Step 3: Freezing latents and fine-tuning the weights of $\mathbf{G}$ to further drive
            down the reconstruction error.
            Lighting manipulation is performed using a separate neural network $\mathbf{A}$ to approximate $\mathbf{M}$
            ($\mathbf{z}=\mathbf{M}^{-1}(\mathbf{w})$)
          </p>
        </div>
      </div>
      <br />
      <div class="row">
        <div class="col-md-12 text-center">
          <img loading="lazy"  class="img-fluid img-border" src="img/grids/00_grid.jpg">
          <img loading="lazy"  class="img-fluid img-border" src="img/grids/01_grid.jpg">
        </div>
      </div>
 -->
          <div class="offset-md-0 col-md-12 ">
            <h2 style="text-align: center; margin-top:100px;">Big LaMa ü¶ô (51M) results</h2>
          </div>
          <div style="margin-top: 40px" class="offset-md-0 col-md-12 ">
            <h3 style="margin-left: -2.5%">Positive examples</h3>
            <p></p>
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/p0.png" alt="" width="100%">
          </div>
          <details>
<summary style="font-size:24px;">More examples</summary>

          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/p1.png" alt="" width="100%">
          </div>
          
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/p3.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/p4.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/p5.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/p7.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/p8.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/p9.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/p10.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/p14.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/p15.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/p16.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/p17.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/p18.png" alt="" width="100%">
          </div>
                    </details>


          <div style="margin-top: 40px" class="offset-md-0 col-md-12 ">
            <h3 style="margin-left: -2.5%">Distortions, Bokeh, Perspective</h3>
            <p></p>
          </div>

          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/p2.png" alt="" width="100%">
          </div>

          
                    <details>
 <summary style="font-size:24px;">More examples</summary>

 <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/n1.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/n2.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/n3.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/n4.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/n5.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/n6.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/n7.png" alt="" width="100%">
          </div>
          </details>

          <div style="margin-top: 40px" class="offset-md-0 col-md-12 ">
            <h3 style="margin-left: -2.5%">Domain transfer examples</h3>
            <p></p>
          </div>
                    <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/o3.png" alt="" width="100%">
          </div>

                    <details>
    <summary style="font-size:24px;">More examples </summary>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/o2.png" alt="" width="100%">
          </div>
                    <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/o1.png" alt="" width="100%">
          </div>

          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/o4.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/o5.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/o6.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/o7.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/o8.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/o9.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/o10.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/o11.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/o12.png" alt="" width="100%">
          </div>
          <div class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/o13.png" alt="" width="100%">
          </div>
          <div style="width:100%" class="">
            <img loading="lazy"  class="img-fluid mb-3" src="img/o14.png" alt="" width="100%">
          </div>
          <!-- <div style="width:100%">
            <img loading="lazy"  class="img-fluid  mb-3" src="img/o15.png" alt="" width="100%">
          </div> -->

          </details>

  </section>

  <section class="showcase">

    <div class="container">


      <div class="row myrow" style="padding-bottom:140px">
        <div class="offset-md-0 col-md-12 ">
          <h2 style="margin-left: -2.5%">Citation</h2>
          <p class="lead mb-0" align="justify">
            <div style="font-weight:normal; font-size: 16pt; background-color:  #F0F0F0;">
            <tt>
            @article{suvorov2021resolution, <br>
              <div style="margin-left: 5%;font-size: 16pt; font-weight:normal; ">
              title={Resolution-robust Large Mask Inpainting with Fourier Convolutions}, <br>
              author={Suvorov, Roman and Logacheva, Elizaveta and Mashikhin, Anton and Remizova, Anastasia and Ashukha, Arsenii and Silvestrov, Aleksei and Kong, Naejin and Goka, Harshith and Park, Kiwoong and Lempitsky, Victor}, <br>
              journal={arXiv preprint arXiv:2109.07161}, <br>
              year={2021} <br>
            </div>
            }</tt>
          </div>
          </p>
        </div>
      </div>
        <br>
        <p style="font-weight:normal; font-size: 16pt;text-align:center">Copyright ¬© 2021</p>
        <br>

      <!-- <div class="row myrow">
        <div class="offset-md-1 col-md-10">
          <h2>Related Work</h2>
          <ul>
            <li><a href="https://github.com/NVlabs/stylegan">A Style-Based Generator Architecture for Generative
                Adversarial Networks</a> in CVPR 2019</li>
            <li><a href="http://www.cgg.cs.tsukuba.ac.jp/~endo/projects/AnimatingLandscape/">Animating Landscape:
                Self-Supervised Learning of Decoupled Motion and Appearance for Single-Image Video Synthesis</a> in
              SIGGRAPH Asia 2019</li>
          </ul>
        </div> -->
    </div>

  </section>
        
  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
</body>

</html>
